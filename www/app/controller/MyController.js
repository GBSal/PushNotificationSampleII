/*
 * File: app/controller/MyController.js
 *
 * This file was generated by Sencha Architect version 2.2.2.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Sencha Touch 2.2.x library, under independent license.
 * License of Sencha Architect does not include license for Sencha Touch 2.2.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('MyApp.controller.MyController', {
    extend: 'Ext.app.Controller',

    config: {
        refs: {
            MainView: '#mainview',
            BookList: '#booklist',
            backButton: '#back',
            BookDetail: '#bookdetail',
            NewBook: '#newbook',
            AddButton: '#btnAdd',
            SearchField: '#txtSearch',
            SaveBook: '#btnSaveBook'
        },

        control: {
            "[action=back]": {
                tap: 'onButtonTap'
            },
            "list": {
                itemtap: 'onListItemTap'
            },
            "[action=Add]": {
                tap: 'onButtonTap1'
            },
            "searchfield": {
                keyup: 'onSearchfieldKeyup'
            },
            "[action=AddBook]": {
                tap: 'onAddBookTap'
            }
        }
    },

    onButtonTap: function(button, e, eOpts) {
        button.hide();

        this.getMainView().animateActiveItem(0,{type:"slide", direction:"left"});

        this.getBookList().deselectAll();


        console.log("button tap");
    },

    onListItemTap: function(dataview, index, target, record, e, eOpts) {
        this.getMainView().animateActiveItem(1,{type:"flip"});

        this.getBackButton().show();


        this.getBookDetail().setData(record.data);

        console.log("item Tapp");
    },

    onButtonTap1: function(button, e, eOpts) {
        this.getMainView().animateActiveItem(2,{type:"slide", direction:"right"});

        this.getBookList().deselectAll();

        this.getBackButton().show();

        console.log("Add new Button");
    },

    onSearchfieldKeyup: function(textfield, e, eOpts) {
        var value   = textfield.getValue(),
            store   = this.getBookList().getStore(),
            query   = new RegExp(value, 'i');

        store.filter('name', query);

        console.log("Key pressed");
    },

    onAddBookTap: function(button, e, eOpts) {
        var n  = Ext.getCmp("txtName").getValue();
        var a = Ext.getCmp("txtAuthor").getValue();
        var d = Ext.getCmp("txtDescription").getValue();

        store   = this.getBookList().getStore();

        store.add( {
            id: '1',
            name: n,
            description:d,
            author: a,
            rating: '1',
            imgurl: ''
        });





        console.log("Add new book clicked ");
    }

});